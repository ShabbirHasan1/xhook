//XHook - v1.5.4 - https://github.com/jpillora/xhook
//Jaime Pillora <dev@jpillora.com> - MIT Copyright 2022
var xhook=function(){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(let t=0;t<this.length;t++){if(this[t]===e)return t}return-1});const e=(e,t)=>Array.prototype.slice.call(e,t);let t=null;"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?t=self:"undefined"!=typeof global?t=global:window&&(t=window);const n="undefined"!=typeof navigator&&navigator.useragent?navigator.userAgent:"";let o=null;(/msie (\d+)/.test(n.toLowerCase())||/trident\/.*; rv:(\d+)/.test(n.toLowerCase()))&&(o=parseInt(RegExp.$1,10));const r=t,s=t.document,a=["load","loadend","loadstart"],i=["progress","abort","error","timeout"],c=e=>["returnValue","totalSize","position"].includes(e),u=function(e,t){for(let n in e){if(c(n))continue;const o=e[n];try{t[n]=o}catch(e){}}return t},d=function(e,t,n){const o=e=>function(o){const r={};for(let e in o){if(c(e))continue;const s=o[e];r[e]=s===t?n:s}return n.dispatchEvent(e,r)};for(let r of Array.from(e))n._has(r)&&(t[`on${r}`]=o(r))},l=function(e){if(s&&null!=s.createEventObject){const t=s.createEventObject();return t.type=e,t}try{return new Event(e)}catch(t){return{type:e}}},f=function(t){let n={};const o=e=>n[e]||[],r={addEventListener:function(e,t,r){n[e]=o(e),n[e].indexOf(t)>=0||(r=void 0===r?n[e].length:r,n[e].splice(r,0,t))},removeEventListener:function(e,t){if(void 0===e)return void(n={});void 0===t&&(n[e]=[]);const r=o(e).indexOf(t);-1!==r&&o(e).splice(r,1)},dispatchEvent:function(){const n=e(arguments),s=n.shift();t||(n[0]=u(n[0],l(s)));const a=r[`on${s}`];a&&a.apply(r,n);const i=o(s).concat(o("*"));for(let e=0;e<i.length;e++){i[e].apply(r,n)}},_has:e=>!(!n[e]&&!r[`on${e}`])};return t&&(r.listeners=t=>e(o(t)),r.on=r.addEventListener,r.off=r.removeEventListener,r.fire=r.dispatchEvent,r.once=function(e,t){var n=function(){return r.off(e,n),t.apply(null,arguments)};return r.on(e,n)},r.destroy=()=>n={}),r};var p=function(e,t){let n;switch(null==t&&(t={}),typeof e){case"object":var o=[];for(let t in e){const r=e[t];n=t.toLowerCase(),o.push(`${n}:\t${r}`)}return o.join("\n")+"\n";case"string":o=e.split("\n");for(let e of Array.from(o))if(/([^:]+):\s*(.+)/.test(e)){n=null!=RegExp.$1?RegExp.$1.toLowerCase():void 0;const e=RegExp.$2;null==t[n]&&(t[n]=e)}return t}return[]},h=r.FormData;const y=function(t){this.fd=t?new h(t):new h,this.form=t;const n=[];Object.defineProperty(this,"entries",{get:()=>(t?e(t.querySelectorAll("input,select")).filter((e=>!["checkbox","radio"].includes(e.type)||e.checked)).map((e=>[e.name,"file"===e.type?e.files:e.value])):[]).concat(n)}),this.append=function(){const t=e(arguments);return n.push(t),this.fd.append.apply(this.fd,t)}.bind(this)};var v={patch(){h&&(r.FormData=y)},unpatch(){h&&(r.FormData=h)},Native:h,Xhook:y};const E=f(!0),g=e=>void 0===e?null:e,m=r.XMLHttpRequest,b=function(){const e=new m,t={};let n,r,s,c=null;var l=0;const h=function(){if(s.status=c||e.status,-1===c&&o<10||(s.statusText=e.statusText),-1===c);else{const t=p(e.getAllResponseHeaders());for(let e in t){const n=t[e];if(!s.headers[e]){const t=e.toLowerCase();s.headers[t]=n}}}},y=function(){w.status=s.status,w.statusText=s.statusText},b=function(){n||w.dispatchEvent("load",{}),w.dispatchEvent("loadend",{}),n&&(w.readyState=0)},x=function(e){for(;e>l&&l<4;)w.readyState=++l,1===l&&w.dispatchEvent("loadstart",{}),2===l&&y(),4===l&&(y(),"text"in s&&(w.responseText=s.text),"xml"in s&&(w.responseXML=s.xml),"data"in s&&(w.response=s.data),"finalUrl"in s&&(w.responseURL=s.finalUrl)),w.dispatchEvent("readystatechange",{}),4===l&&(!1===t.async?b():setTimeout(b,0))},L=function(e){if(4!==e)return void x(e);const n=E.listeners("after");var o=function(){if(n.length>0){const e=n.shift();2===e.length?(e(t,s),o()):3===e.length&&t.async?e(t,s,o):o()}else x(4)};o()};var w=f();t.xhr=w,e.onreadystatechange=function(t){try{2===e.readyState&&h()}catch(e){}4===e.readyState&&(r=!1,h(),function(){if(e.responseType&&"text"!==e.responseType)"document"===e.responseType?(s.xml=e.responseXML,s.data=e.responseXML):s.data=e.response;else{s.text=e.responseText,s.data=e.responseText;try{s.xml=e.responseXML}catch(e){}}"responseURL"in e&&(s.finalUrl=e.responseURL)}()),L(e.readyState)};const R=function(){n=!0};w.addEventListener("error",R),w.addEventListener("timeout",R),w.addEventListener("abort",R),w.addEventListener("progress",(function(t){l<3?L(3):e.readyState<=3&&w.dispatchEvent("readystatechange",{})})),"withCredentials"in e&&(w.withCredentials=!1),w.status=0;for(let e of Array.from(i.concat(a)))w[`on${e}`]=null;if(w.open=function(e,o,a,i,c){l=0,n=!1,r=!1,t.headers={},t.headerNames={},t.status=0,t.method=e,t.url=o,t.async=!1!==a,t.user=i,t.pass=c,s={},s.headers={},L(1)},w.send=function(n){let o,c;for(o of["type","timeout","withCredentials"])c="type"===o?"responseType":o,c in w&&(t[o]=w[c]);t.body=n;const l=E.listeners("before");var f=function(){if(!l.length)return function(){for(o of(d(i,e,w),w.upload&&d(i.concat(a),e.upload,w.upload),r=!0,e.open(t.method,t.url,t.async,t.user,t.pass),["type","timeout","withCredentials"]))c="type"===o?"responseType":o,o in t&&(e[c]=t[o]);for(let n in t.headers){const o=t.headers[n];n&&e.setRequestHeader(n,o)}t.body instanceof v.Xhook&&(t.body=t.body.fd),e.send(t.body)}();const n=function(e){if("object"==typeof e&&("number"==typeof e.status||"number"==typeof s.status))return u(e,s),"data"in e||(e.data=e.response||e.text),void L(4);f()};n.head=function(e){u(e,s),L(2)},n.progress=function(e){u(e,s),L(3)};const p=l.shift();1===p.length?n(p(t)):2===p.length&&t.async?p(t,n):n()};f()},w.abort=function(){c=-1,r?e.abort():w.dispatchEvent("abort",{})},w.setRequestHeader=function(e,n){const o=null!=e?e.toLowerCase():void 0,r=t.headerNames[o]=t.headerNames[o]||e;t.headers[r]&&(n=t.headers[r]+", "+n),t.headers[r]=n},w.getResponseHeader=e=>g(s.headers[e?e.toLowerCase():void 0]),w.getAllResponseHeaders=()=>g(p(s.headers)),e.overrideMimeType&&(w.overrideMimeType=function(){e.overrideMimeType.apply(e,arguments)}),e.upload){let e=f();w.upload=e,t.upload=e}return w.UNSENT=0,w.OPENED=1,w.HEADERS_RECEIVED=2,w.LOADING=3,w.DONE=4,w.response="",w.responseText="",w.responseXML=null,w.readyState=0,w.statusText="",w};b.UNSENT=0,b.OPENED=1,b.HEADERS_RECEIVED=2,b.LOADING=3,b.DONE=4;var x={patch(){m&&(r.XMLHttpRequest=b)},unpatch(){m&&(r.XMLHttpRequest=m)},Native:m,Xhook:b};const L=r.fetch,w=function(e,t){null==t&&(t={headers:{}});let n=null;e instanceof Request?n=e:t.url=e;const o=E.listeners("before"),r=E.listeners("after");return new Promise((function(e,s){let a=e;const i=function(){return t.body instanceof v.Xhook&&(t.body=t.body.fd),t.headers&&(t.headers=new Headers(t.headers)),n||(n=new Request(t.url,t)),u(t,n)};var c=function(e){if(!r.length)return a(e);const t=r.shift();return 2===t.length?(t(i(),e),c(e)):3===t.length?t(i(),e,c):c(e)};const d=function(t){if(void 0!==t){const n=new Response(t.body||t.text,t);return e(n),void c(n)}l()};var l=function(){if(!o.length)return void f();const e=o.shift();return 1===e.length?d(e(t)):2===e.length?e(i(),d):void 0},f=()=>L(i()).then((e=>c(e))).catch((function(e){return a=s,c(e),s(e)}));l()}))};var R={patch(){L&&(r.fetch=w)},unpatch(){L&&(r.fetch=L)},Native:L,Xhook:w};const T=E;return T.EventEmitter=f,T.before=function(e,t){if(e.length<1||e.length>2)throw"invalid hook";return T.on("before",e,t)},T.after=function(e,t){if(e.length<2||e.length>3)throw"invalid hook";return T.on("after",e,t)},T.enable=function(){x.patch(),R.patch(),v.patch()},T.disable=function(){x.unpatch(),R.unpatch(),v.unpatch()},T.XMLHttpRequest=x.Native,T.fetch=R.Native,T.FormData=v.Native,T.headers=p,T.enable(),T}();
//# sourceMappingURL=xhook.min.js.map
